## ----Aufgabe 1-----------------------------------------------------------------------------------------------
x <- c(10, 8, 13, 9, 11, 14, 6, 4, 12, 7, 5)
y <- c(8.1, 6.9, 7.5, 8.8, 8.3, 9.9, 7.2, 4.2, 10.8, 4.8, 5.6)


## ----Aufgabe 2-----------------------------------------------------------------------------------------------
x + y
x - y
x * y
x / y
x %*% y
t(x) %*% y
# x %*% t(y) 
# t(x) %*% t(y)


## ----Aufgabe 3-----------------------------------------------------------------------------------------------
plot(x, y, main = "Streudiagramm")


## ----Aufgabe 4-----------------------------------------------------------------------------------------------
data <- data.frame(x = x, y = y)
data


## ----Aufgabe 5-----------------------------------------------------------------------------------------------
model <- lm(formula = y ~ x, data = data)
plot(data)
abline(model)


## ----Aufgabe 6-----------------------------------------------------------------------------------------------
summary(model)


## ----Aufgabe 12----------------------------------------------------------------------------------------------
x_1 <- c(1, 2, 3, 4, 5, 1, 2, 3, 4, 5)
x_2 <- c(1, 1, 2, 2, 3, 3, 4, 4, 5, 5)
y <- c(1, 3, 1, 5, 2, -3, -3, -1, -2, -2)
data <- data.frame(y, x_1, x_2)
model <- lm(y ~ x_1 + x_2, data)
model$coefficients %*% c(1, 6, -1)


## ----Aufgabe 13----------------------------------------------------------------------------------------------
btc <- fHMM::download_data("BTC-USD", from = "2022-01-01", to = "2022-12-31")
eth <- fHMM::download_data("ETH-USD", from = "2022-01-01", to = "2022-12-31")
cov(btc$Close, eth$Close)
cor(btc$Close, eth$Close)


## ----Aufgabe 16----------------------------------------------------------------------------------------------
x <- 1:10
y <- x
cor(x, y)
y <- -x
cor(x, y)
y <- (x - mean(x))^2
cor(x, y)


## ----Aufgabe 18----------------------------------------------------------------------------------------------
pbinom(13, size = 100, prob = 0.2)
pbinom(14, size = 100, prob = 0.2)

binom.test(13, n = 100, p = 0.2, alternative = "less")
binom.test(14, n = 100, p = 0.2, alternative = "less")


## ----Aufgabe 19----------------------------------------------------------------------------------------------
f.x <- function(x, p) dbinom(x, size = 100, prob = p)
plot(0:100, f.x(x = 0:100, p = 0.2), type = "o", xlab = "x", ylab = "f.x")
lines(0:13, f.x(x = 0:13, p = 0.2), type = "o", col = "red")
lines(0:100, f.x(x = 0:100, p = 0.1), type = "o", col = "blue")
abline(v = 14)
1 - pbinom(13, size = 100, prob = 0.1)


## ----Aufgabe 20----------------------------------------------------------------------------------------------
pbinom(15, size = 100, prob = 0.2)
1 - pbinom(15, size = 100, prob = 0.1)

n_range <- 1:1000
crit <- qbinom(0.05, size = n_range, prob = 0.2)
beta <- 1 - pbinom(crit - 1, size = n_range, prob = 0.1)
plot(n_range, beta, type = "l")
abline(h = 0.05)
min(which(beta < 0.05))

