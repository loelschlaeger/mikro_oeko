---
title: "Ex 02"
author: "Lennart Oelschläger"
date: "`r Sys.Date()`"
course: "Einf. Oeko"
term: "WS 2023"
output: 
  pdf_document:
    template: template.tex
    highlight: null
solution: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  include = rmarkdown::metadata$solution, comment = '#', prompt = TRUE
)
```

## Rückblick

In der gepoolten Querschnittsanalyse liegen mehrere Zufallsstichproben vor, die die gleiche Struktur, d.h. Beobachtungen über die gleichen Variablen aufweisen. Eine Idee ist dann, die Daten in einem \emph{Pool} zusammenzuführen um so eine Stichprobe mit größerem Umfang zu erhalten.

Dabei können verschiedene Probleme entstehen, da sich die Verteilungen der Beobachtungen in den einzelnen Stichproben unterscheiden können. Ein konkretes Problem könnte sein, dass die Stichproben zu unterschiedlichen Zeitpunkten erhoben wurden, zu denen zwar das zugrundeliegende Modell gleichgeblieben ist, die Koeffizienten sich jedoch verändert haben. Verschiedene Problemlagen sollen in diesem und dem nächsten Übungsblatt analysiert werden.

## Aufgaben

In dieser Aufgabe soll der Einfluss der Ausbildungsjahre auf den Stundenlohn untersucht werden. Dazu wird das folgende Modell für die Population spezifiziert,

\begin{equation} \label{ausgangsmodell}
wage = \beta_0 + \beta_1 educ + u
\end{equation}

wobei \emph{wage} den Stundenlohn bezeichnet und \emph{educ} die Ausbildung in Jahren.

1. Unter welcher Annahme ist das obige Modell korrekt spezifiziert?

```{r}
data <- wooldridge::cps78_85
wage <- exp(data$lwage)

### wage
model <- lm(wage ~ educ, data)
white <- lm(residuals(model) ~ predict(model) + I(predict(model)^2))
summary(white)

### log wage
model <- lm(lwage ~ educ, data)
white <- lm(residuals(model) ~ predict(model) + I(predict(model)^2))
summary(white)
```
	
2. Der Datensatz \texttt{cps78\_85.csv} aus Wooldridge (2009) beinhaltet Beobachtungen aus zwei unabhängigen Stichproben aus den Jahren 1978 und 1985. Lesen Sie den Datensatz ein und machen Sie sich ein Bild von den Variablen \texttt{wage} und \texttt{educ}. Unterscheiden Sie auch zwischen den einzelnen Stichproben.

3. Schätzen Sie das gepoolte Regressionsmodell in \eqref{ausgangsmodell} und interpretieren Sie die Koeffizienten. Sind die Koeffizienten statistisch signifikant?

4. Plotten Sie die Residuen $\hat{u}$ gegen die gefitteten Werte $\hat{y}$. Ist die Varianz der Residuen konstant? Testen Sie mithilfe des Breusch-Pagan-Tests (z.B. Wooldridge 2009: 273), ob die Annahme der Homoskedastie verletzt ist.

5. Welche Auswirkungen hat Heteroskedastie auf die KQ-Schätzung? Welche Möglichkeiten gibt es, mit dem Problem der Heteroskedastie umzugehen?

6. Prüfen Sie im folgenden Modell, ob Heteroskedastie vorliegt.
\begin{equation} \label{log_modell}
\log(wage) = \beta_0 + \beta_1 educ + u
\end{equation}
Sind die Koeffizienten statistisch signifikant? Wie sind die Parameter $\beta_0$ und $\beta_1$ zu interpretieren?

7. Schätzen Sie nun ein Modell, das für das zweite Jahr eine eigene Konstante zulässt.
\begin{equation} \label{dummy_modell}
\log(wage) = \beta_0 + \beta_1 educ + \gamma_0 y85 + u
\end{equation}
Welche Interpretation besitzt $\gamma_0$? Ist es gerechtfertigt, die Konstante im Modell zu behalten? Argumentieren Sie!

8. Schätzen Sie als nächstes das folgende Modell, das zusätzlich einen Interaktionsterm enthält.
\begin{equation} \label{dummy_interaktion_modell}
\log(wage) = \beta_0 + \beta_1 educ + \gamma_0 y85 + \gamma_1 y85 \cdot educ + u
\end{equation}
Welche Interpretation besitzt $\gamma_1$? Bleibt die Interpretation von $\gamma_0$ aus Aufgabenteil (g) gleich? Sind die Koeffizienten statistisch signifikant?

9. Wie kann getestet werden, ob die Koeffizienten gemeinsam signifikant sind? Führen Sie den Test durch.

